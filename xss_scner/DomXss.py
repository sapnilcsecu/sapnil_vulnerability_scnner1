'''
Created on Jan 5, 2021

@author: Nasir uddin

'''

#import requests
import mechanize
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
import time


class DomXss(object):

   
    
    def is_DOMXss(self,url):
        is_domXss= False;       
        chrome_options = Options()
        chrome_options.add_argument('--headless')
        driver = webdriver.Chrome('./chromedriver',options=chrome_options)
        attack_payload='<script>alert(1)</script>'
        driver.get(url+"#"+attack_payload)
        
        html = driver.page_source
        #time.sleep(2)
        if attack_payload in html:
            is_domXss=True
            #print('DOM based xss')
        # close web browser
        driver.close()
        return is_domXss






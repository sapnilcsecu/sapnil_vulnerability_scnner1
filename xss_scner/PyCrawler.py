'''
Created on Jan 5, 2021

@author: Nasir uddin
'''

from DomXss import DomXss
from Reflection_xss import Reflection 
from utility import get_links


class PyCrawler(object):    
    def __init__(self):    
        #self.starting_url = starting_url    
        self.visited = set() 
        self.visited_form = set()
        self.dom=DomXss() 
        self.reflect=Reflection()  

    
           

    def crawl_DOM(self, url):                   
        for link in get_links(url):    
            if link in self.visited:        
                continue                    
            
            if self.dom.is_DOMXss(link):
                print("Dom based xss found at "+link)        
            self.visited.add(link)            
            #info = self.extract_info(link)    
            self.crawl_DOM(link) 
            
    def crawl_reflect(self, url):
        if self.reflect.reflection_xss(url):
            print("reflection xss found at "+url)     
        for link in get_links(url):    
            if link in self.visited:        
                continue                    
            
               
            self.visited.add(link)            
            #info = self.extract_info(link)    
            self.crawl_reflect(link)        
   

            
def main():
    crawler = PyCrawler()        
    crawler.crawl_reflect("http://localhost:8090/hack_webdemo/reflection.jsp")
    #print("on the scanner")
if __name__ == '__main__':
    main()
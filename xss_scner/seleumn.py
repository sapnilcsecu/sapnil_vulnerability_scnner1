'''
Created on Jan 10, 2021

@author: Nasir uddin
'''

from selenium import webdriver
from selenium.webdriver.chrome.options import Options
import time

def main():
    chrome_options = Options()
    chrome_options.add_argument('--headless')
    driver = webdriver.Chrome('./chromedriver',options=chrome_options)
    attack_payload='<script>alert(1)</script>'
    driver.get("http://localhost:8090/hack_webdemo/DOMbasedxss.jsp#"+attack_payload)
    
    html = driver.page_source
    time.sleep(2)
    if attack_payload in html:
        print('DOM based xss')
    # close web browser
    driver.close()

if __name__ == '__main__':
    main()